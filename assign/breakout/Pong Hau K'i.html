<!doctype html>
<html lang="en">
<head>
	<title>Pong Hau Qi</title>
</head>
<p id="demo">This is a Pong Hau Qi game</p>
<p>Every turn you got:</p>
<p id="demo1">This is the timer</p>
<style>
	#div1, #div2, #div3,#div4,#div5 {
        float: left;
        width: 35px;
        height: 35px;
        margin: auto;
        position: relative;
        border:1px solid black;
	}
    #div6, #div7, #div8, #div9{
        float: left;
        width: 37px;
        height: 37px;
        margin: auto;
        position: relative;
    }
    #div0 { padding: 3px; border: 1px solid black; }
</style>

<script>
    var count = 0;
    var count1 = 0;
    var count2 = 0;
    var id1, id2= 0;
    var turn = 0;
    var position = new Array("div1","div2","div4","div5");
    var myTime;
    var value;
    function init(){
        //this is a initialize count
        start();
        count = 1;
    }
    function reloadPage(){
        location.reload();
    }
	function allowDrop(ev) {
		ev.preventDefault();
	}
	function drag(ev) {
	    if(count == 1) {
            id1 = ev.target.id;
            if (turn == 0) {
                if (id1 == "drag1" || id1 == "drag2") {
                    ev.dataTransfer.setData("text", id1);
                    turn = 1;
                    if (id1 == "drag1") {
                        count1 = 0;
                    } else {
                        count1 = 1;
                    }
                }
            } else if (turn == 1) {
                if (id1 == "drag3" || id1 == "drag4") {
                    ev.dataTransfer.setData("text", id1);
                    turn = 0;
                    if (id1 == "drag3") {
                        count2 = 0;
                    } else {
                        count2 = 1;
                    }
                }
            }
        }
	}
	function drop(ev) {
		ev.preventDefault();
        id2 = ev.target.id;
		var data = ev.dataTransfer.getData("text");
		ev.target.appendChild(document.getElementById(data));
        //reminder of Turns
        if(turn == 0) {
            document.getElementById("demo").innerHTML = "Player 1's turn";
            if(count2 == 0){
                position[2] = id2;
            }else{
                position[3] = id2;
            }
        }else{
            document.getElementById("demo").innerHTML = "Player 2's turn";
            if(count1 == 0){
                position[0] = id2;
            }else{
                position[1] = id2;
            }
        }
        alertWinner();
        //re-enter the timer if game need to be continued.
        start();
	}
	function displayCount(){
        txtOutput.value = position;
    }
    function displayTurn(){
        if(turn == 0) {
            Turn.value = "Player 1 's turn";
        }else{
            Turn.value = "Player 2 's turn";
        }
    }
    function start () {
            clearInterval(myTime);
            document.getElementById("demo").innerHTML = "Player 1's turn";
            value = 21;
            myTime = setInterval(displayTime, 1000);
    }
    function stop() {
            clearInterval(myTime);
            count = 0;
    }
    function displayTime() {
        document.getElementById("demo1").innerHTML = --value;
        if(value <= 0){
            alertTimeOut();
        }
    }
    function alertTimeOut(){
        alert("Your time is out!");
        stop();
    }
    function alertWinner(){
        if((position[0] == "div1" && position[1] == "div4") || (position[0] == "div4" && position[1] == "div1")){
            if((position[2] == "div3" && position[3] == "div5") || (position[2] == "div5" && position[3] == "div3")) {
                alert("Player 2 is the winner!");
                stop()
            }
        }
        if((position[0] == "div2" && position[1] == "div5") || (position[0] == "div5" && position[1] == "div2")){
            if((position[2] == "div3" && position[3] == "div4") || (position[2] == "div4" && position[3] == "div3")) {
                alert("Player 2 is the winner!");
                stop()
            }
        }
        if((position[2] == "div1" && position[3] == "div4") || (position[2] == "div4" && position[3] == "div1")){
            if((position[0] == "div3" && position[1] == "div5") || (position[0] == "div5" && position[1] == "div3")){
                alert("Player 1 is the winner!");
                stop()
            }
        }
        if((position[2] == "div2" && position[3] == "div5") || (position[2] == "div5" && position[3] == "div2")){
            if((position[0] == "div3" && position[1] == "div4") || (position[0] == "div4" && position[1] == "div3")){
                alert("Player 1 is the winner!");
                stop()
            }
        }
    }
</script>
<body>
<div id = "div0" style= "position: relative; height: 150px; width: 120px; margin: auto;">

    <div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)">
	    <img src="image1/piece1.png" draggable="true" ondragstart="drag(event)" id="drag1" width="35" height="35">
    </div>
    <div id="div6"></div>
    <div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="image1/piece1.png" draggable="true" ondragstart="drag(event)" id="drag2" width="35" height="35">
    </div>
    <div id="div7"></div>
    <div id="div3" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    <div id="div8"></div>
    <div id="div4" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="image1/piece2.png" draggable="true" ondragstart="drag(event)" id="drag3" width="35" height="35">
    </div>
    <div id="div9"></div>
    <div id="div5" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img src="image1/piece2.png" draggable="true" ondragstart="drag(event)" id="drag4" width="35" height="35">
    </div>

</div>

<form action = "" style= "position: relative; height: 150px; width: 110px;">
  <fieldset>
  <label>This is the count </label>
    <input type = "button"
       value = "click me"
       onclick = "displayCount(), displayTurn()"/>
      <input type = "button"
             value = "start"
             onclick = "init()"/>
      <input type = "button"
             value = "pause"
             onclick = "stop()"/>
      <input type = "button"
             value = "restart"
             onclick = "reloadPage()"/>
    <input type = "text"
       id = "txtOutput" />
      <input type = "text"
             id = "Turn" />
</fieldset>
</form>

</body>
</html>